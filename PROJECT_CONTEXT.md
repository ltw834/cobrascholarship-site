# Project Context — CobraScholarship

- Domain: https://cobrascholarship.org
- Local project root: /Users/bugattimacstudio/Sites/cobrascholarship
- Staging folder: _staging

## Key Files in _staging/

- _staging/.htaccess
- _staging/CHANGELOG.md
- _staging/apply-handler.php
- _staging/apply-save.php
- _staging/apply.php
- _staging/backups/.htaccess
- _staging/composer.json
- _staging/images/hero.jpg
- _staging/images/hero.webp
- _staging/images/impact.jpg
- _staging/images/whatwedo.jpg
- _staging/robots.txt
- _staging/sitemap.xml
- _staging/test-mail.php
- _staging/thank-you.html
- _staging/vendor/autoload.php
- _staging/vendor/composer/ClassLoader.php
- _staging/vendor/composer/InstalledVersions.php
- _staging/vendor/composer/autoload_classmap.php
- _staging/vendor/composer/autoload_namespaces.php
- _staging/vendor/composer/autoload_psr4.php
- _staging/vendor/composer/autoload_real.php
- _staging/vendor/composer/autoload_static.php
- _staging/vendor/composer/installed.json
- _staging/vendor/composer/installed.php
- _staging/vendor/composer/platform_check.php
- _staging/vendor/phpmailer/phpmailer/README.md
- _staging/vendor/phpmailer/phpmailer/SECURITY.md
- _staging/vendor/phpmailer/phpmailer/SMTPUTF8.md
- _staging/vendor/phpmailer/phpmailer/composer.json
- _staging/vendor/phpmailer/phpmailer/get_oauth_token.php
- _staging/vendor/phpmailer/phpmailer/language/phpmailer.lang-af.php
- _staging/vendor/phpmailer/phpmailer/language/phpmailer.lang-ar.php
- _staging/vendor/phpmailer/phpmailer/language/phpmailer.lang-as.php
- _staging/vendor/phpmailer/phpmailer/language/phpmailer.lang-az.php
- _staging/vendor/phpmailer/phpmailer/language/phpmailer.lang-ba.php
- _staging/vendor/phpmailer/phpmailer/language/phpmailer.lang-be.php
- _staging/vendor/phpmailer/phpmailer/language/phpmailer.lang-bg.php
- _staging/vendor/phpmailer/phpmailer/language/phpmailer.lang-bn.php
- _staging/vendor/phpmailer/phpmailer/language/phpmailer.lang-ca.php
- _staging/vendor/phpmailer/phpmailer/language/phpmailer.lang-cs.php
- _staging/vendor/phpmailer/phpmailer/language/phpmailer.lang-da.php
- _staging/vendor/phpmailer/phpmailer/language/phpmailer.lang-de.php
- _staging/vendor/phpmailer/phpmailer/language/phpmailer.lang-el.php
- _staging/vendor/phpmailer/phpmailer/language/phpmailer.lang-eo.php
- _staging/vendor/phpmailer/phpmailer/language/phpmailer.lang-es.php
- _staging/vendor/phpmailer/phpmailer/language/phpmailer.lang-et.php
- _staging/vendor/phpmailer/phpmailer/language/phpmailer.lang-fa.php
- _staging/vendor/phpmailer/phpmailer/language/phpmailer.lang-fi.php
- _staging/vendor/phpmailer/phpmailer/language/phpmailer.lang-fo.php
- _staging/vendor/phpmailer/phpmailer/language/phpmailer.lang-fr.php
- _staging/vendor/phpmailer/phpmailer/language/phpmailer.lang-gl.php
- _staging/vendor/phpmailer/phpmailer/language/phpmailer.lang-he.php
- _staging/vendor/phpmailer/phpmailer/language/phpmailer.lang-hi.php
- _staging/vendor/phpmailer/phpmailer/language/phpmailer.lang-hr.php
- _staging/vendor/phpmailer/phpmailer/language/phpmailer.lang-hu.php
- _staging/vendor/phpmailer/phpmailer/language/phpmailer.lang-hy.php
- _staging/vendor/phpmailer/phpmailer/language/phpmailer.lang-id.php
- _staging/vendor/phpmailer/phpmailer/language/phpmailer.lang-it.php
- _staging/vendor/phpmailer/phpmailer/language/phpmailer.lang-ja.php
- _staging/vendor/phpmailer/phpmailer/language/phpmailer.lang-ka.php
- _staging/vendor/phpmailer/phpmailer/language/phpmailer.lang-ko.php
- _staging/vendor/phpmailer/phpmailer/language/phpmailer.lang-ku.php
- _staging/vendor/phpmailer/phpmailer/language/phpmailer.lang-lt.php
- _staging/vendor/phpmailer/phpmailer/language/phpmailer.lang-lv.php
- _staging/vendor/phpmailer/phpmailer/language/phpmailer.lang-mg.php
- _staging/vendor/phpmailer/phpmailer/language/phpmailer.lang-mn.php
- _staging/vendor/phpmailer/phpmailer/language/phpmailer.lang-ms.php
- _staging/vendor/phpmailer/phpmailer/language/phpmailer.lang-nb.php
- _staging/vendor/phpmailer/phpmailer/language/phpmailer.lang-nl.php
- _staging/vendor/phpmailer/phpmailer/language/phpmailer.lang-pl.php
- _staging/vendor/phpmailer/phpmailer/language/phpmailer.lang-pt.php
- _staging/vendor/phpmailer/phpmailer/language/phpmailer.lang-pt_br.php
- _staging/vendor/phpmailer/phpmailer/language/phpmailer.lang-ro.php
- _staging/vendor/phpmailer/phpmailer/language/phpmailer.lang-ru.php
- _staging/vendor/phpmailer/phpmailer/language/phpmailer.lang-si.php
- _staging/vendor/phpmailer/phpmailer/language/phpmailer.lang-sk.php
- _staging/vendor/phpmailer/phpmailer/language/phpmailer.lang-sl.php
- _staging/vendor/phpmailer/phpmailer/language/phpmailer.lang-sr.php
- _staging/vendor/phpmailer/phpmailer/language/phpmailer.lang-sr_latn.php
- _staging/vendor/phpmailer/phpmailer/language/phpmailer.lang-sv.php
- _staging/vendor/phpmailer/phpmailer/language/phpmailer.lang-tl.php
- _staging/vendor/phpmailer/phpmailer/language/phpmailer.lang-tr.php
- _staging/vendor/phpmailer/phpmailer/language/phpmailer.lang-uk.php
- _staging/vendor/phpmailer/phpmailer/language/phpmailer.lang-ur.php
- _staging/vendor/phpmailer/phpmailer/language/phpmailer.lang-vi.php
- _staging/vendor/phpmailer/phpmailer/language/phpmailer.lang-zh.php
- _staging/vendor/phpmailer/phpmailer/language/phpmailer.lang-zh_cn.php
- _staging/vendor/phpmailer/phpmailer/src/DSNConfigurator.php
- _staging/vendor/phpmailer/phpmailer/src/Exception.php
- _staging/vendor/phpmailer/phpmailer/src/OAuth.php
- _staging/vendor/phpmailer/phpmailer/src/OAuthTokenProvider.php
- _staging/vendor/phpmailer/phpmailer/src/PHPMailer.php
- _staging/vendor/phpmailer/phpmailer/src/POP3.php
- _staging/vendor/phpmailer/phpmailer/src/SMTP.php

## Form Fields in apply.php

csrf, email, message, name, ts, viewport, website

## Handler & Data Storage

- Handler: _staging/apply-save.php
- CSV (server): public_html/backups/applications.csv

## Excerpts (first ~3KB each)

### apply.php
```
<?php
session_start();
if (empty($_SESSION['csrf'])) { $_SESSION['csrf'] = bin2hex(random_bytes(32)); }
?><!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Cobra Scholarship – Apply</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <link rel="preload" href="/critical.min.css" as="style" onload="this.rel='stylesheet'">
  <noscript><link rel="stylesheet" href="/critical.min.css"></noscript>
</head>
<body>
  <main>
    <h1>Apply for the Cobra Youth Scholarship</h1>
    <form method="post" action="/apply-handler.php" novalidate>
      <input type="hidden" name="csrf" value="<?php echo htmlspecialchars($_SESSION['csrf']); ?>">
      <!-- honeypot field for bots -->
      <input type="text" name="website" autocomplete="off" tabindex="-1"
             style="position:absolute;left:-5000px" aria-hidden="true">
      <input type="hidden" name="ts" value="<?php echo time(); ?>">
      <p><label>Full name<br><input required name="name"></label></p>
      <p><label>Email<br><input required type="email" name="email"></label></p>
      <p><label>Message<br><textarea required name="message" rows="6"></textarea></label></p>
      <button type="submit">Submit</button>
    </form>
  </main>
</body>
</html>

```

### apply-save.php
```
<?php
declare(strict_types=1);
session_start();
function post(string $k): string { return trim($_POST[$k] ?? ''); }

// CSRF + honeypot
$csrf = post('csrf');
if (!$csrf || !isset($_SESSION['csrf']) || !hash_equals($_SESSION['csrf'], $csrf)) { http_response_code(400); echo "Invalid session. Please reload the form."; exit; }
if (post('website') !== '') { header('Location: /thank-you.html', true, 303); exit; }

// Collect fields
$name=post('name'); $email=post('email'); $phone=post('phone'); $age=post('age'); $city=post('city'); $zip=post('zip');
$u18=post('u18'); $gname=post('guardian_name'); $gemail=post('guardian_email');

// Financial need
$need_frpl=post('need_frpl')==='yes'?'yes':''; $need_snap=post('need_snap')==='yes'?'yes':''; $need_medicaid=post('need_medicaid')==='yes'?'yes':'';
$need_housing=post('need_housing')==='yes'?'yes':''; $need_unemployment=post('need_unemployment')==='yes'?'yes':'';
$need_singleparent=post('need_singleparent')==='yes'?'yes':''; $need_other=post('need_other');

// Support requested (updated to mentorship)
$support_tuition=post('support_tuition')==='yes'?'yes':''; $support_uniform=post('support_uniform')==='yes'?'yes':'';
$support_competition=post('support_competition')==='yes'?'yes':''; $support_mentorship=post('support_mentorship')==='yes'?'yes':'';

$message=post('message'); $consent=post('consent');

// Minimal validation
$age_ok = ctype_digit($age) && (int)$age>=4 && (int)$age<=26;
if(!$name || !filter_var($email,FILTER_VALIDATE_EMAIL) || !$age_ok || !$city || !$zip || $consent!=='yes'){
  http_response_code(400); echo "Please complete required fields (name, email, age 4–26, city, ZIP, consent)."; exit;
}

// Save to CSV (private)
$csvDir = __DIR__.'/backups';
@mkdir($csvDir,0775,true);
$deny = $csvDir.'/.htaccess';
if(!file_exists($deny)){ @file_put_contents($deny,"Require all denied\nDeny from all\n"); }

$file = $csvDir.'/applications.csv';
$hasFile = file_exists($file);
$legacy = false;
if($hasFile){
  $rf=@fopen($file,'r');
  if($rf){ $hdr=fgetcsv($rf); fclose($rf); if(is_array($hdr) && in_array('support_transport',$hdr,true)) $legacy=true; }
}
$f=@fopen($file,'ab');
if(!$f){ http_response_code(500); echo "Server could not save your application. Please email info@cobrascholarship.org."; exit; }

if(!$hasFile){
  fputcsv($f, [
    'timestamp','name','email','phone','age','city','zip','under_18',
    'guardian_name','guardian_email',
    'need_frpl','need_snap','need_medicaid','need_housing','need_unemployment','need_singleparent','need_other',
    'support_tuition','support_uniform','support_competition','support_mentorship',
    'message','ip','ua'
  ]);
}

$rowCommon = [
  date('c'),
  str_replace(["\n","\r"],' ',$name),
  $email,
  str_replace(["\n","\r"],' ',$phone),
  $age,
  str_replace(["\n","\r"],' ',$city),
  str_replace(["\n","\r"],' ',$zip),
  $u18==='yes'?'yes':'',
  str_replace(["\n","\r"],' ',$gname),
  $gemail,
  $need_frpl,$need_snap,$need_medicaid,$need_housing,$need_unemployment,$need_si
```

### thank-you.html
```
<!doctype html><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Thank you • Cobra Youth Scholarship</title><style>body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;padding:32px;max-width:720px;margin:auto}</style><h1>Thank you!</h1><p>Your application has been received. We’ll be in touch soon.</p><p><a href="/">Back to Home</a></p>

```

### .htaccess
```
# Cobra Scholarship Security Configuration

# Force HTTPS and canonical domain
RewriteEngine On
RewriteCond %{HTTPS} off [OR]
RewriteCond %{HTTP_HOST} ^www\.(.+)$ [NC]
RewriteRule ^(.*)$ https://cobrascholarship.org/$1 [R=301,L]

# Security Headers
<IfModule mod_headers.c>
    # HSTS - HTTP Strict Transport Security
    Header always set Strict-Transport-Security "max-age=31536000; includeSubDomains; preload" env=HTTPS
    
    # Content Security Policy
    Header always set Content-Security-Policy "default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'; img-src 'self' data: https:; font-src 'self'; connect-src 'self'; frame-ancestors 'none';"
    
    # X-Frame-Options
    Header always set X-Frame-Options "DENY"
    
    # X-Content-Type-Options
    Header always set X-Content-Type-Options "nosniff"
    
    # X-XSS-Protection
    Header always set X-XSS-Protection "1; mode=block"
    
    # Referrer Policy
    Header always set Referrer-Policy "strict-origin-when-cross-origin"
    
    # Permissions Policy
    Header always set Permissions-Policy "geolocation=(), microphone=(), camera=(), payment=(), usb=(), bluetooth=(), magnetometer=(), gyroscope=()"
</IfModule>

# Block access to sensitive files and directories
<FilesMatch "(^#.*#|\.(bak|config|sql|fla|psd|ini|log|sh|inc|swp|dist)|~)$">
    Require all denied
</FilesMatch>

# Block access to dotfiles and directories
<FilesMatch "^\.">
    Require all denied
</FilesMatch>

<DirectoryMatch "^\.|\/\.">
    Require all denied
</DirectoryMatch>

# Block access to specific directories
<Directory ~ "^/(\.well-known|cgi-bin)$">
    Require all denied
</Directory>

# Disable directory browsing
Options -Indexes

# Disable server signature
ServerTokens Prod
<IfModule mod_security.c>
    SecServerSignature " "
</IfModule>

# Cache Control for Performance
<IfModule mod_expires.c>
    ExpiresActive on
    
    # Cache images for 1 year
    ExpiresByType image/jpg "access plus 1 year"
    ExpiresByType image/jpeg "access plus 1 year"
    ExpiresByType image/gif "access plus 1 year"
    ExpiresByType image/png "access plus 1 year"
    ExpiresByType image/webp "access plus 1 year"
    ExpiresByType image/svg+xml "access plus 1 year"
    
    # Cache CSS and JS for 1 month
    ExpiresByType text/css "access plus 1 month"
    ExpiresByType text/javascript "access plus 1 month"
    ExpiresByType application/javascript "access plus 1 month"
    
    # Cache HTML for 1 hour
    ExpiresByType text/html "access plus 1 hour"
    
    # Cache fonts for 1 year
    ExpiresByType application/font-woff "access plus 1 year"
    ExpiresByType application/font-woff2 "access plus 1 year"
</IfModule>

# Gzip Compression
<IfModule mod_deflate.c>
    AddOutputFilterByType DEFLATE text/plain
    AddOutputFilterByType DEFLATE text/html
    AddOutputFilterByType DEFLATE text/xml
    AddOutputFilterByType DEFLATE text/css
    AddOutputFilterByType DEFLATE application/xml
    AddOutputFilterByType D
```

### robots.txt
```
User-agent: *
Allow: /

Sitemap: https://cobrascholarship.org/sitemap.xml

```

### sitemap.xml
```
<?xml version="1.0" encoding="UTF-8"?>
<urlset xmlns="http://www.sitemaps.org/schemas/sitemap/0.9">
  <url><loc>https://cobrascholarship.org/</loc></url>
  <url><loc>https://cobrascholarship.org/apply.php</loc></url>
  <url><loc>https://cobrascholarship.org/thank-you.html</loc></url>
</urlset>

```


## VS Code SFTP (masked)

```json
{
  "name": "CobraScholarship (FTPS)",
  "host": "server91.web-hosting.com",
  "protocol": "ftp",
  "port": 21,
  "username": "cobrlnjx",
  "password": "***MASKED***",
  "remotePath": "public_html",
  "uploadOnSave": false,
  "secure": true,
  "secureOptions": {
    "rejectUnauthorized": false
  },
  "passive": true,
  "ignore": [
    "**/.vscode/**",
    "**/.git/**",
    "**/node_modules/**",
    "**/.DS_Store",
    "**/*.log"
  ]
}
```
